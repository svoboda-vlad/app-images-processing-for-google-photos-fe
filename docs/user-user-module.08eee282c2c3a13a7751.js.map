{"version":3,"sources":["./src/app/user/user.module.ts","./src/app/user-edit/user-edit.component.html","./src/app/user-edit/user-edit.component.ts","./src/app/user-detail/user-detail.component.ts","./src/app/user-detail/user-detail.component.scss","./src/app/user/user-routing.module.ts","./src/app/user-detail/user-detail.component.html","./src/app/user-edit/user-edit.component.scss"],"names":[],"mappings":"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","file":"user-user-module.08eee282c2c3a13a7751.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { UserRoutingModule } from './user-routing.module';\nimport { UserDetailComponent } from '../user-detail/user-detail.component';\nimport { UserEditComponent } from '../user-edit/user-edit.component';\nimport { ReactiveFormsModule } from '@angular/forms';\n\n\n@NgModule({\n  declarations: [\n    UserDetailComponent,\n    UserEditComponent\n  ],\n  imports: [\n    CommonModule,\n    UserRoutingModule,\n    ReactiveFormsModule\n  ]\n})\nexport class UserModule { }\n","export default \"<h2>Edit User</h2>\\n<div *ngIf=\\\"user$ | async as user; else loadingOrError\\\">\\n  <div class=\\\"alert alert-danger\\\" *ngIf=\\\"userUpdateError\\\">\\n    <strong>Failed to update user!</strong> Please check the data.\\n  </div>\\n  <form class=\\\"form\\\" (ngSubmit)=\\\"updateUser()\\\" [formGroup]=\\\"userEditForm\\\">\\n    <div class=\\\"form-group\\\">\\n      <label for=\\\"givenName\\\">Given Name</label>\\n      <input type=\\\"text\\\" class=\\\"form-control\\\" formControlName=\\\"givenName\\\" />\\n      <div *ngIf=\\\"givenName\\\">\\n        <div *ngIf=\\\"givenName.invalid && (givenName.dirty || givenName.touched)\\\" class=\\\"alert alert-danger\\\">\\n          <div *ngIf=\\\"givenName.errors\\\">\\n            <div *ngIf=\\\"givenName.errors.required || givenName.errors.minlength || givenName.errors.maxlength\\\">\\n              Given name must be between 1 and 255 characters long.\\n            </div>\\n          </div>\\n        </div>\\n      </div>\\n    </div>\\n\\n    <div class=\\\"form-group\\\">\\n      <label for=\\\"familyName\\\">Family Name</label>\\n      <input type=\\\"text\\\" class=\\\"form-control\\\" formControlName=\\\"familyName\\\" />\\n      <div *ngIf=\\\"familyName\\\">\\n        <div *ngIf=\\\"familyName.invalid && (familyName.dirty || familyName.touched)\\\" class=\\\"alert alert-danger\\\">\\n          <div *ngIf=\\\"familyName.errors\\\">\\n            <div *ngIf=\\\"familyName.errors.required || familyName.errors.minlength || familyName.errors.maxlength\\\">\\n              Family name must be between 1 and 255 characters long.\\n            </div>\\n          </div>\\n        </div>\\n      </div>\\n    </div>\\n    <button type=\\\"submit\\\" class=\\\"btn btn-primary\\\" [disabled]=\\\"userEditForm.invalid\\\">Save</button>\\n  </form>\\n</div>\\n\\n<ng-template #loadingOrError>\\n  <ng-container *ngIf=\\\"error; else loading\\\">\\n    <div class=\\\"alert alert-danger\\\">{{ error }}</div>\\n  </ng-container>\\n  <ng-template #loading>\\n    <div>Loading ...</div>\\n  </ng-template>\\n</ng-template>\\n\";","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { FormBuilder, Validators } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { Observable, Subscription, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { User, UserService } from '../user/user.service';\n\n@Component({\n  selector: 'ipfgp-user-edit',\n  templateUrl: './user-edit.component.html',\n  styleUrls: ['./user-edit.component.scss']\n})\nexport class UserEditComponent implements OnInit, OnDestroy {\n\n  userUpdateError = false;\n  error!: Object;\n  userUpdateSubscription!: Subscription;\n  user$!: Observable<User>;\n  userObject!: User;\n\n  userEditForm = this.fb.group({\n    givenName: [null, [Validators.required, Validators.minLength(1), Validators.maxLength(255)]],\n    familyName: [null, [Validators.required, Validators.minLength(1), Validators.maxLength(255)]]\n  });\n\n  constructor(private fb: FormBuilder,\n    private router: Router,\n    private userService: UserService\n  ) { }\n\n  ngOnInit(): void {\n      this.user$ = this.userService.getCurrentUser().pipe(\n        map(user => {\n          this.userObject = user;\n          this.userEditForm.patchValue({\n            givenName: user.givenName,\n            familyName: user.familyName\n          });\n          return user;\n        }),\n        catchError(err => {\n          this.error = err;\n          return throwError(err);\n        })\n      )\n  }\n\n  updateUser(): void {\n    const user: User = new User(\n      this.userObject.username,\n      this.userObject.lastLoginDateTime,\n      this.userObject.previousLoginDateTime,\n      this.userEditForm.get('givenName')!.value,\n      this.userEditForm.get('familyName')!.value,\n      this.userObject.userRoles\n    );\n    this.userUpdateSubscription = this.userService\n      .updateUser(user)\n      .subscribe(\n        () => {\n          this.userUpdateError = false;\n          this.router.navigate(['/user']);\n        },\n        () => this.userUpdateError = true\n      );\n  }\n\n  get givenName() { return this.userEditForm.get('givenName'); }\n\n  get familyName() { return this.userEditForm.get('familyName'); }\n\n  ngOnDestroy() {\n    if (this.userUpdateSubscription != null) this.userUpdateSubscription.unsubscribe();\n  }\n\n}\n","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ModalDismissReasons, NgbModal } from '@ng-bootstrap/ng-bootstrap';\nimport { Observable, Subscription, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { LoginService } from '../login/login.service';\nimport { User, UserService } from '../user/user.service';\n\n@Component({\n  selector: 'ipfgp-user-detail',\n  templateUrl: './user-detail.component.html',\n  styleUrls: ['./user-detail.component.scss']\n})\nexport class UserDetailComponent implements OnInit, OnDestroy {\n\n  user$: Observable<User> | null = null;\n  error: Object | null = null;\n  deleteUserSubscription: Subscription | null = null;\n  deleteError: Object | null = null;\n  closeResult = '';\n\n  constructor(private userService: UserService, private route: ActivatedRoute,\n    private router: Router, private loginService: LoginService,\n    private modalService: NgbModal) {\n  }\n\n  ngOnInit(): void {\n    this.user$ = this.userService.getCurrentUser()\n      .pipe(\n        catchError((err) => {\n          this.router.navigate(['/login']);\n          return throwError(err);\n        })\n      );\n  }\n\n  ngOnDestroy() {\n    if (this.deleteUserSubscription != null) this.deleteUserSubscription.unsubscribe();\n  }\n\n  deleteUser() {\n    this.deleteUserSubscription = this.userService.deleteUser()\n      .subscribe(() => {\n        this.deleteError = false;\n        this.loginService.logOut();\n        this.userService.logOut();\n        this.router.navigate(['/login']);\n      },\n        () => this.deleteError = true);\n  }\n\n  open(content: any) {\n    this.modalService.open(content).result.then((result) => {\n      this.closeResult = `Closed with: ${result}`;\n    }, (reason) => {\n      this.closeResult = `Dismissed ${this.getDismissReason(reason)}`;\n    });\n  }\n\n  private getDismissReason(reason: any): string {\n    if (reason === ModalDismissReasons.ESC) {\n      return 'by pressing ESC';\n    } else if (reason === ModalDismissReasons.BACKDROP_CLICK) {\n      return 'by clicking on a backdrop';\n    } else {\n      return `with: ${reason}`;\n    }\n  }  \n\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ1c2VyLWRldGFpbC5jb21wb25lbnQuc2NzcyJ9 */\";","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { UserDetailComponent } from '../user-detail/user-detail.component';\nimport { UserEditComponent } from '../user-edit/user-edit.component';\n\nconst routes: Routes = [{\n  path: '',\n  component: UserDetailComponent\n},\n{\n  path: 'edit',\n  component: UserEditComponent\n}];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class UserRoutingModule { }\n","export default \"<h2>User Detail</h2>\\n<div *ngIf=\\\"user$ | async as user; else loadingOrError\\\">\\n  <div class=\\\"table-responsive-sm\\\" *ngIf=\\\"user; else notFound\\\">\\n    <table class=\\\"table table-sm\\\">\\n      <thead>\\n        <tr class=\\\"table-secondary\\\">\\n          <th scope=\\\"col\\\">Name</th>\\n          <th scope=\\\"col\\\">Value</th>\\n        </tr>\\n      </thead>\\n      <tbody>\\n        <tr>\\n          <th>Username</th>\\n          <td>{{ user.username }}</td>\\n        </tr>\\n        <tr>\\n          <th>Given Name</th>\\n          <td>{{ user.givenName }}</td>\\n        </tr>\\n        <tr>\\n          <th>Family Name</th>\\n          <td>{{ user.familyName }}</td>\\n        </tr>\\n        <tr>\\n          <th>Last Login</th>\\n          <td>{{ user.lastLoginDateTime | date:'yyyy-MM-dd HH:mm' }}</td>\\n        </tr>\\n        <tr>\\n          <th>Previous Login</th>\\n          <td>{{ user.previousLoginDateTime | date:'yyyy-MM-dd HH:mm' }}</td>\\n        </tr>\\n        <tr>\\n          <th>Roles</th>\\n          <td><span *ngFor=\\\"let userRoles of user.userRoles; let i = index\\\"><span *ngIf=\\\"i>0\\\">, </span>{{ userRoles.role.name }}</span></td>\\n        </tr>\\n      </tbody>\\n    </table>\\n    <div>\\n      <button class=\\\"btn btn-primary m-1\\\" routerLink=\\\"/user/edit\\\">Edit</button>\\n      <button class=\\\"btn btn-primary m-1\\\" (click)=\\\"open(content)\\\">Delete</button>\\n    </div>\\n  </div>\\n  <ng-template #notFound>\\n    <div class=\\\"alert alert-warning\\\">No record found.</div>\\n  </ng-template>\\n</div>\\n\\n<ng-template #loadingOrError>\\n  <ng-container *ngIf=\\\"error; else loading\\\">\\n    <div class=\\\"alert alert-danger\\\">{{ error }}</div>\\n  </ng-container>\\n  <ng-template #loading>\\n    <div>Loading ...</div>\\n  </ng-template>\\n</ng-template>\\n\\n<ng-template #content let-modal>\\n  <div class=\\\"modal-header\\\">\\n    <h4 class=\\\"modal-title\\\" id=\\\"modal-basic-title\\\">Warning</h4>\\n  </div>\\n  <div class=\\\"modal-body\\\">\\n        <div>Are you sure you want to delete your account with all your user data?</div>\\n  </div>\\n  <div class=\\\"modal-footer\\\">\\n    <button type=\\\"button\\\" class=\\\"btn btn-outline-dark\\\" (click)=\\\"modal.close('No')\\\">No</button>    \\n    <button type=\\\"button\\\" class=\\\"btn btn-outline-dark\\\" (click)=\\\"modal.close('Yes'); deleteUser()\\\">Yes</button>\\n  </div>\\n</ng-template>\\n\";","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ1c2VyLWVkaXQuY29tcG9uZW50LnNjc3MifQ== */\";"],"sourceRoot":"webpack:///"}